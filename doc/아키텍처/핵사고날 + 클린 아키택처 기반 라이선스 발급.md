# ğŸ§© í—¥ì‚¬ê³ ë‚  + í´ë¦° ì•„í‚¤í…ì²˜ ê¸°ë°˜ ë¼ì´ì„ ìŠ¤ ë°œê¸‰ ì˜ˆì œ (ë¦¬íŒ©í† ë§ ë²„ì „)

## âœ… ê°œìš”

- ControllerëŠ” API ìš”ì²­(Request)ì„ ë°›ê³ 
- ServiceëŠ” Request â†’ Domain â†’ Persistence ì²˜ë¦¬ í›„, Response ë°˜í™˜
- ê° ê³„ì¸µì˜ ì±…ì„ì„ ëª…í™•íˆ ë¶„ë¦¬í•œ êµ¬ì¡°

---

## âœ… 1. API ê³„ì¸µ (Controller)

```java
@RestController
@RequiredArgsConstructor
@RequestMapping("/api/licenses")
public class LicenseController {

    private final IssueLicenseUseCase issueLicenseUseCase;

    @PostMapping
    public ResponseEntity<LicenseResponse> issue(@RequestBody @Valid LicenseRequest request) {
        LicenseResponse response = issueLicenseUseCase.issueLicense(request);
        return ResponseEntity.ok(response);
    }
}
```

---

## âœ… 2. UseCase ì¸í„°í˜ì´ìŠ¤

```java
public interface IssueLicenseUseCase {
    LicenseResponse issueLicense(LicenseRequest request);
}
```

---

## âœ… 3. Application Service

```java
@Service
@RequiredArgsConstructor
public class LicenseService implements IssueLicenseUseCase {

    private final LicenseRepositoryPort repository;
    private final LicenseNotificationPort notification;
    private final LicenseMapper mapper;

    @Override
    public LicenseResponse issueLicense(LicenseRequest request) {
        License license = mapper.toDomain(request);
        repository.save(license);
        notification.notify(license.getIssuedTo() + "ë‹˜ì—ê²Œ ë¼ì´ì„ ìŠ¤ ë°œê¸‰ë¨");
        return mapper.toResponse(license);
    }
}
```

---

## âœ… 4. Mapper

```java
@Component
public class LicenseMapper {

    public License toDomain(LicenseRequest request) {
        return new License(
            UUID.randomUUID().toString(),
            request.getUserName(),
            new Email(request.getEmail())
        );
    }

    public LicenseResponse toResponse(License license) {
        return new LicenseResponse(license.getLicenseKey(), license.getIssuedTo());
    }
}
```

---

## âœ… 5. ë„ë©”ì¸ ëª¨ë¸

```java
public class License {
    private final String licenseKey;
    private final String issuedTo;
    private final Email email;

    public License(String licenseKey, String issuedTo, Email email) {
        if (licenseKey == null || issuedTo == null || email == null)
            throw new IllegalArgumentException("í•„ìˆ˜ ì •ë³´ ëˆ„ë½");
        this.licenseKey = licenseKey;
        this.issuedTo = issuedTo;
        this.email = email;
    }

    public String getLicenseKey() { return licenseKey; }
    public String getIssuedTo() { return issuedTo; }
    public Email getEmail() { return email; }
}
```

```java
public class Email {
    private final String value;

    public Email(String value) {
        if (!value.matches(".+@.+\..+")) {
            throw new IllegalArgumentException("ì˜ëª»ëœ ì´ë©”ì¼ í˜•ì‹");
        }
        this.value = value;
    }

    public String getValue() { return value; }
}
```

---

## âœ… 6. Outbound Port

```java
public interface LicenseRepositoryPort {
    void save(License license);
}

public interface LicenseNotificationPort {
    void notify(String message);
}
```

---

## âœ… 7. Adapter - Persistence

```java
@Entity
public class LicenseJpaEntity {
    @Id @GeneratedValue
    private Long id;
    private String licenseKey;
    private String issuedTo;
    private String email;
}
```

```java
@Component
@RequiredArgsConstructor
public class LicenseJpaAdapter implements LicenseRepositoryPort {

    private final SpringDataLicenseRepository repository;

    @Override
    public void save(License license) {
        LicenseJpaEntity entity = new LicenseJpaEntity();
        entity.setLicenseKey(license.getLicenseKey());
        entity.setIssuedTo(license.getIssuedTo());
        entity.setEmail(license.getEmail().getValue());
        repository.save(entity);
    }
}
```

---

## âœ… 8. Adapter - Notification

```java
@Component
public class EmailNotificationAdapter implements LicenseNotificationPort {
    @Override
    public void notify(String message) {
        System.out.println("ğŸ“§ ì´ë©”ì¼ ì „ì†¡: " + message);
    }
}
```

---

## âœ… 9. ìš”ì²­/ì‘ë‹µ DTO

```java
public class LicenseRequest {
    @NotBlank
    private String userName;

    @Email
    private String email;
}
```

```java
public class LicenseResponse {
    private String licenseKey;
    private String issuedTo;

    public LicenseResponse(String licenseKey, String issuedTo) {
        this.licenseKey = licenseKey;
        this.issuedTo = issuedTo;
    }
}
```

---

## âœ… ì•„í‚¤í…ì²˜ íë¦„ ì •ë¦¬

```
[LicenseController] â†’ [IssueLicenseUseCase] â†’ [LicenseService]
    â†³ LicenseMapper: Request â†’ Domain â†’ Response
    â†³ Domain: License, Email
    â†³ Outbound Ports: LicenseRepositoryPort, LicenseNotificationPort
        â†³ Adapters: JPA, Email ì•Œë¦¼
```